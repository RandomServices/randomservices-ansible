[Unit]
Description={{ app_name }} background
After=network.target

# Uncomment for socket activation (see below)
# Requires={{app_name}}.socket

[Service]
# Foreground process (do not use --daemon in ExecStart or config.rb)
Type=simple

User={{ app_name }}

# The path to the puma application root
WorkingDirectory=/var/www/{{ app_name }}/current

Environment=RBENV_ROOT=/usr/local/rbenv
{% for key, value in app.environment.iteritems() %}
  Environment="{{key}}={{value}}"
{% endfor %}

ExecStart=/usr/local/rbenv/bin/rbenv exec bundle exec foreman run -m web=0

Restart=always
RestartSec=25s

[Install]
WantedBy=multi-user.target
